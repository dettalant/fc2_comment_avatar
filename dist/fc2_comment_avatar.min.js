/*!
 * @file fc2_comment_avatar.js
 * See {@link https://github.com/dettalant/fc2_comment_avatar| dettalant/fc2_comment_avatar}
 *
 * @author dettalant
 * @version v0.1.0
 * @license MIT License
 */
var fc2_comment_avatar=function(a){"use strict";function r(a){this.message=a,this.name="NavManagerError"}r.prototype.toString=function(){return this.name+": "+this.message};function t(a){if(this.isUseDataSrc=!1,void 0===a)throw new r("初期化に必要な情報が入力されませんでした。CommentAvatarクラスの初期化引数には必要情報が格納されたobjectを入れてください");var t=document.getElementsByClassName(a.avatarClassName);if(0===t.length)throw new r("アバター要素の取得に失敗しました");this.avatarContainers=t,this.avatarClassName=a.avatarClassName,this.avatarImgClassName=a.avatarImgClassName,this.avatarsList=a.avatarsList,a.isUseDataSrc&&(this.isUseDataSrc=a.isUseDataSrc);var s=this.scanAvatarCodes();this.avatarsImageOverWrite(s)}return t.prototype.scanAvatarCodes=function(){for(var a=this.avatarContainers.length,t=[],s=0;s<a;s++){var r=this.avatarContainers[s],e=r.dataset.avatarCode;if(void 0!==e&&(-1!==e.indexOf("[[")||-1!==e.indexOf("]]"))){var i=/\[\[[\s　]*?([^\[\]\s　]+?)[\s　]*?\]\]/.exec(e);if(null!==i){var n=i[1];if(this.isMatchAvatarName(n)){var v=this.genDefaultAvatarData();v.imgEl=r.querySelector("."+this.avatarImgClassName),v.name=n,v.url=this.avatarsList[n],t.push(v)}}}}return t},t.prototype.isMatchAvatarName=function(a){return!!this.avatarsList[a]},t.prototype.genDefaultAvatarData=function(){var a="__default__",t="//static.fc2.com/image/sh_design/no_image/no_image_300x300.png";return this.avatarsList[a]&&(t=this.avatarsList[a]),{imgEl:null,name:a,url:t}},t.prototype.avatarsImageOverWrite=function(a){for(var t=a.length,s=0;s<t;s++){var r=a[s];null!==r.imgEl&&(this.isUseDataSrc?r.imgEl.dataset.src=r.url:r.imgEl.src=r.url)}},a.CommentAvatar=t,a}({});
